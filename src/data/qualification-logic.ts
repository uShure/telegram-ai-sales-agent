// –õ–æ–≥–∏–∫–∞ –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞ –ø–µ—Ä–µ–¥ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º –∫—É—Ä—Å–æ–≤

export interface ClientQualification {
  format?: "online" | "offline" | null;
  direction?: "haircuts" | "coloring" | "business" | null;
  experience?: "beginner" | "intermediate" | "expert" | null;
  qualified: boolean;
}

// –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º, —á—Ç–æ –º—ã —É–∂–µ –∑–Ω–∞–µ–º –æ –∫–ª–∏–µ–Ω—Ç–µ
export function analyzeQualification(messages: string[]): ClientQualification {
  const allText = messages.join(" ").toLowerCase();

  const qualification: ClientQualification = {
    format: null,
    direction: null,
    experience: null,
    qualified: false,
  };

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º–∞—Ç
  if (
    allText.includes("–æ—á–Ω") ||
    allText.includes("–æ—Ñ–ª–∞–π–Ω") ||
    allText.includes("–æ—Ñ–ª–∞–π–Ω") ||
    allText.includes("—Ç–≤–æ—Ä—á–µ—Å–∫") ||
    allText.includes("–¥–µ—Ä–µ–≤–Ω")
  ) {
    qualification.format = "offline";
  } else if (
    allText.includes("–æ–Ω–ª–∞–π–Ω") ||
    allText.includes("–¥–∏—Å—Ç–∞–Ω—Ü") ||
    allText.includes("—É–¥–∞–ª–µ–Ω")
  ) {
    qualification.format = "online";
  }

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
  if (
    allText.includes("—Å—Ç—Ä–∏–∂–∫") ||
    allText.includes("–ø–∞—Ä–∏–∫–º–∞—Ö–µ—Ä") ||
    allText.includes("—Å—Ç—Ä–∏—á—å")
  ) {
    qualification.direction = "haircuts";
  } else if (
    allText.includes("–∫–æ–ª–æ—Ä") ||
    allText.includes("–æ–∫—Ä–∞—à") ||
    allText.includes("—Ü–≤–µ—Ç") ||
    allText.includes("–±–ª–æ–Ω–¥") ||
    allText.includes("–¥–Ω–∫")
  ) {
    qualification.direction = "coloring";
  } else if (
    allText.includes("—Å–∞–ª–æ–Ω") ||
    allText.includes("—É–ø—Ä–∞–≤–ª–µ–Ω") ||
    allText.includes("–±–∏–∑–Ω–µ—Å") ||
    allText.includes("—Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª")
  ) {
    qualification.direction = "business";
  }

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–ø—ã—Ç
  if (
    allText.includes("–Ω–∞—á–∏–Ω–∞") ||
    allText.includes("–Ω–æ–≤–∏—á–æ–∫") ||
    allText.includes("—Å –Ω—É–ª—è") ||
    allText.includes("–Ω–µ—Ç –æ–ø—ã—Ç–∞")
  ) {
    qualification.experience = "beginner";
  } else if (
    allText.includes("–æ–ø—ã—Ç") ||
    allText.includes("—Ä–∞–±–æ—Ç–∞—é") ||
    allText.includes("–ª–µ—Ç –≤ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏") ||
    allText.includes("–≥–æ–¥–∞ –≤ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏")
  ) {
    qualification.experience = "intermediate";
  } else if (
    allText.includes("—ç–∫—Å–ø–µ—Ä—Ç") ||
    allText.includes("–ø—Ä–µ–ø–æ–¥–∞–≤–∞") ||
    allText.includes("–Ω–∞—Å—Ç–∞–≤–Ω–∏–∫") ||
    allText.includes("—Ç—Ä–µ–Ω–µ—Ä")
  ) {
    qualification.experience = "expert";
  }

  // –°—á–∏—Ç–∞–µ–º –∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º, –µ—Å–ª–∏ –∑–Ω–∞–µ–º —Ö–æ—Ç—è –±—ã —Ñ–æ—Ä–º–∞—Ç –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
  qualification.qualified = !!(qualification.format && qualification.direction);

  return qualification;
}

// –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
export function getQualificationQuestions(
  qualification: ClientQualification,
): string {
  const questions: string[] = [];

  // –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –µ—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
  if (
    !qualification.format &&
    !qualification.direction &&
    !qualification.experience
  ) {
    questions.push(
      "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ú–µ–Ω—è –∑–æ–≤—É—Ç –í–µ—Ä–∞, —è –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç –∞–∫–∞–¥–µ–º–∏–∏ SOINTERA. –ü–æ–º–æ–≥—É –ø–æ–¥–æ–±—Ä–∞—Ç—å –∏–¥–µ–∞–ª—å–Ω—ã–π –∫—É—Ä—Å –∏–º–µ–Ω–Ω–æ –¥–ª—è –≤–∞—Å! üòä",
    );
  }

  // –ü–æ—Ä—è–¥–æ–∫ –≤–∞–∂–µ–Ω: —Å–Ω–∞—á–∞–ª–∞ —Ñ–æ—Ä–º–∞—Ç, –ø–æ—Ç–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –ø–æ—Ç–æ–º –æ–ø—ã—Ç
  if (!qualification.format) {
    questions.push(
      "–°–Ω–∞—á–∞–ª–∞ –æ–ø—Ä–µ–¥–µ–ª–∏–º—Å—è —Å —Ñ–æ—Ä–º–∞—Ç–æ–º: –≤–∞–º —É–¥–æ–±–Ω–µ–µ —É—á–∏—Ç—å—Å—è –æ—á–Ω–æ –≤ –¢–≤–æ—Ä—á–µ—Å–∫–æ–π –¥–µ—Ä–µ–≤–Ω–µ –∏–ª–∏ –æ–Ω–ª–∞–π–Ω?",
    );
  } else if (!qualification.direction) {
    questions.push(
      "–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å –≤—ã–±–µ—Ä–∏—Ç–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: —Å—Ç—Ä–∏–∂–∫–∏ –∏–ª–∏ –∫–æ–ª–æ—Ä–∏—Å—Ç–∏–∫–∞?",
    );
  } else if (!qualification.experience) {
    questions.push(
      "–°—É–ø–µ—Ä! –ò –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–æ–ø—Ä–æ—Å: –∫–∞–∫–æ–π —É –≤–∞—Å –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã? –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –ø–æ–¥–æ–±—Ä–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –Ω—É–∂–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è.",
    );
  }

  return questions.join("\n\n");
}

// –ü—Ä–æ–≤–µ—Ä—è–µ–º, —ç—Ç–æ –æ–±—â–∏–π –∑–∞–ø—Ä–æ—Å –∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π
export function isGeneralRequest(message: string): boolean {
  const lower = message.toLowerCase();

  // –¢–æ—á–Ω—ã–µ —Ñ—Ä–∞–∑—ã –∫–æ—Ç–æ—Ä—ã–µ —Ç–æ—á–Ω–æ —Ç—Ä–µ–±—É—é—Ç –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—é
  const exactPhrases = [
    "—Ä–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ –∫—É—Ä—Å—ã",
    "—Ä–∞—Å—Å–∫–∞–∂–∏—Ç–µ –ø—Ä–æ –∫—É—Ä—Å—ã",
    "–∫–∞–∫–∏–µ –∫—É—Ä—Å—ã",
    "–∫–∞–∫–∏–µ –µ—Å—Ç—å –∫—É—Ä—Å—ã",
    "—á—Ç–æ –µ—Å—Ç—å",
    "–≤—Å–µ –∫—É—Ä—Å—ã",
    "–ø—Ä–æ –æ–±—É—á–µ–Ω–∏–µ",
    "—Ö–æ—á—É —É—á–∏—Ç—å—Å—è",
    "–ø–æ–¥–æ–±—Ä–∞—Ç—å –∫—É—Ä—Å",
  ];

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ—á–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
  if (
    exactPhrases.some((phrase) => lower === phrase || lower === phrase + "?")
  ) {
    return true;
  }

  // –û–±—â–∏–µ —Ñ—Ä–∞–∑—ã –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
  const generalPhrases = [
    "—Ä–∞—Å—Å–∫–∞–∂–∏",
    "—Ä–∞—Å—Å–∫–∞–∂–∏—Ç–µ",
    "–∫–∞–∫–∏–µ –µ—Å—Ç—å",
    "—á—Ç–æ –µ—Å—Ç—å",
    "–∫–∞–∫–∏–µ –∫—É—Ä—Å—ã",
    "–≤—Å–µ –∫—É—Ä—Å—ã",
    "–ø—Ä–æ –∫—É—Ä—Å—ã",
    "–æ–± –æ–±—É—á–µ–Ω–∏–∏",
    "–∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ",
    "—Ö–æ—á—É —É—á–∏—Ç—å—Å—è",
    "–ø–æ–¥–æ–±—Ä–∞—Ç—å –∫—É—Ä—Å",
    "–æ–±—É—á–µ–Ω–∏–µ",
    "–Ω–∞—É—á–∏—Ç—å—Å—è",
    "—Ö–æ—á—É –Ω–∞ –∫—É—Ä—Å",
  ];

  // –ò–°–ö–õ–Æ–ß–ê–ï–ú —Ñ—Ä–∞–∑—ã –∫–æ—Ç–æ—Ä—ã–µ –ù–ï –¥–æ–ª–∂–Ω—ã –∑–∞–ø—É—Å–∫–∞—Ç—å –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—é
  const excludePhrases = [
    "–ø—Ä–æ –¥–Ω–∫",
    "–ø—Ä–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç",
    "–ø—Ä–æ —Å—Ç—Ä–∏–∂–∫–∏",
    "–ø—Ä–æ –∫–æ–ª–æ—Ä",
    "–≤—Å–µ –æ—á–Ω—ã–µ",
    "–≤—Å–µ –æ–Ω–ª–∞–π–Ω",
    "–ø–æ–∫–∞–∂–∏ –≤—Å–µ",
    "—Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö",
  ];

  // –ï—Å–ª–∏ –µ—Å—Ç—å –∏—Å–∫–ª—é—á–∞—é—â–∏–µ —Ñ—Ä–∞–∑—ã - —ç—Ç–æ –ù–ï –æ–±—â–∏–π –∑–∞–ø—Ä–æ—Å
  if (excludePhrases.some((phrase) => lower.includes(phrase))) {
    return false;
  }

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–æ—Ä–æ—Ç–∫–æ–µ (–º–µ–Ω–µ–µ 40 —Å–∏–º–≤–æ–ª–æ–≤) –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–±—â—É—é —Ñ—Ä–∞–∑—É
  // –£–±–∏—Ä–∞–µ–º "–æ—á–Ω—ã–µ –∫—É—Ä—Å—ã" –∏ "–æ–Ω–ª–∞–π–Ω –∫—É—Ä—Å—ã" –∏–∑ –æ–±—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
  if (
    message.length < 40 &&
    generalPhrases.some((phrase) => lower.includes(phrase))
  ) {
    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º - —ç—Ç–æ –Ω–µ –æ–±—â–∏–π –∑–∞–ø—Ä–æ—Å
    if (
      (lower.includes("–æ—á–Ω") || lower.includes("–æ–Ω–ª–∞–π–Ω")) &&
      (lower.includes("—Å—Ç—Ä–∏–∂") || lower.includes("–∫–æ–ª–æ—Ä"))
    ) {
      return false;
    }
    return true;
  }

  // –û–¥–∏–Ω–æ—á–Ω—ã–µ —Å–ª–æ–≤–∞ –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –∑–∞–ø—É—Å–∫–∞—Ç—å –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—é
  const singleWordTriggers = ["–∫—É—Ä—Å—ã", "–æ–±—É—á–µ–Ω–∏–µ", "—É—á–∏—Ç—å—Å—è"];
  if (message.length < 15 && singleWordTriggers.includes(lower.trim())) {
    return true;
  }

  return false;
}

// –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ª–∏ –∫–ª–∏–µ–Ω—Ç –¥–µ—Ç–∞–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫—É—Ä—Å–∞
export function isAskingForDetails(message: string): boolean {
  const lower = message.toLowerCase();

  // –ò–°–ö–õ–Æ–ß–ê–ï–ú –æ–±—â–∏–µ —Ñ—Ä–∞–∑—ã –ø—Ä–æ –∫—É—Ä—Å—ã
  if (
    lower === "—Ä–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ –∫—É—Ä—Å—ã" ||
    lower === "—Ä–∞—Å—Å–∫–∞–∂–∏—Ç–µ –ø—Ä–æ –∫—É—Ä—Å—ã" ||
    lower === "—Ä–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ –∫—É—Ä—Å—ã?" ||
    lower === "—Ä–∞—Å—Å–∫–∞–∂–∏—Ç–µ –ø—Ä–æ –∫—É—Ä—Å—ã?"
  ) {
    return false;
  }

  // –í—ã–±–æ—Ä –ø–æ –Ω–æ–º–µ—Ä—É
  if (/^[1-3]$/.test(message.trim())) {
    return true;
  }

  // –í—ã–±–æ—Ä —Å–ª–æ–≤–∞–º–∏
  const choiceWords = [
    "–ø–µ—Ä–≤—ã–π",
    "–≤—Ç–æ—Ä–æ–π",
    "—Ç—Ä–µ—Ç–∏–π",
    "–ø–µ—Ä–≤—ã–π –∫—É—Ä—Å",
    "–≤—Ç–æ—Ä–æ–π –∫—É—Ä—Å",
    "—Ç—Ä–µ—Ç–∏–π –∫—É—Ä—Å",
  ];
  if (choiceWords.includes(lower.trim())) {
    return true;
  }

  // –ó–∞–ø—Ä–æ—Å—ã –¥–µ—Ç–∞–ª–µ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∫—É—Ä—Å–æ–≤
  const detailPhrases = [
    "–ø—Ä–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç",
    "–ø—Ä–æ –¥–Ω–∫",
    "–ø—Ä–æ —Å—Ç—Ä–∏–∂–∫–∏ 2.0",
    "–ø—Ä–æ –∫–æ—Ä–æ—Ç–∫–∏–µ",
    "—Ä–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç",
    "—Ä–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ –¥–Ω–∫",
    "–ø–æ–¥—Ä–æ–±–Ω–µ–µ –æ",
    "–ø–æ–¥—Ä–æ–±–Ω–µ–µ –ø—Ä–æ",
    "—á—Ç–æ –∑–∞ –∫—É—Ä—Å",
    "—Ä–∞—Å—Å–∫–∞–∂–∏ –ø–æ–¥—Ä–æ–±–Ω–µ–µ",
  ];

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ñ—Ä–∞–∑ –æ –¥–µ—Ç–∞–ª—è—Ö
  if (detailPhrases.some((phrase) => lower.includes(phrase))) {
    return true;
  }

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π –∫—É—Ä—Å–æ–≤
  const courseNames = [
    "—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç",
    "–¥–Ω–∫ —Ü–≤–µ—Ç–∞",
    "—Å—Ç—Ä–∏–∂–∫–∏ 2.0",
    "–∫–æ—Ä–æ—Ç–∫–∏–µ —Å—Ç—Ä–∏–∂–∫–∏",
    "–Ω–∞—Å—Ç–∞–≤–Ω–∏–∫",
    "—Ñ–∞–∫—É–ª—å—Ç–µ—Ç",
    "–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ",
  ];

  // –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–æ—Ä–æ—Ç–∫–æ–µ –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –∫—É—Ä—Å–∞ —Å –≤–æ–ø—Ä–æ—Å–æ–º –æ –¥–µ—Ç–∞–ª—è—Ö
  if (message.length < 50 && courseNames.some((name) => lower.includes(name))) {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç - –µ—Å—Ç—å –ª–∏ –≤–æ–ø—Ä–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞
    const questionWords = [
      "—á—Ç–æ",
      "–∫–∞–∫–æ–π",
      "–∫–∞–∫–∞—è",
      "—Ä–∞—Å—Å–∫–∞–∂–∏",
      "–ø—Ä–æ",
      "–ø–æ–¥—Ä–æ–±–Ω–µ–µ",
    ];
    if (questionWords.some((word) => lower.includes(word))) {
      return true;
    }
  }

  return false;
}

// –ö—Ä–∞—Ç–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –æ—Ç–ª–∏—á–∏–π
export function getShortCoursePresentation(
  courses: any[],
  qualification: ClientQualification,
): string {
  if (courses.length === 0) {
    return "–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –Ω–µ –Ω–∞—à–ª–∞ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –∫—É—Ä—Å–æ–≤ –ø–æ –≤–∞—à–∏–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º. –î–∞–≤–∞–π—Ç–µ —É—Ç–æ—á–Ω–∏–º, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?";
  }

  let response = "";

  // –í—Å—Ç—É–ø–ª–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–ø—ã—Ç–∞ –∏ —Ñ–æ—Ä–º–∞—Ç–∞
  if (qualification.experience === "beginner") {
    response = "–û—Ç–ª–∏—á–Ω–æ! –î–ª—è –Ω–∞—á–∏–Ω–∞—é—â–µ–≥–æ –º–∞—Å—Ç–µ—Ä–∞ —É –Ω–∞—Å –µ—Å—Ç—å —ç—Ç–∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã:\n\n";
  } else if (qualification.experience === "intermediate") {
    response = "–°—É–ø–µ—Ä! –° –≤–∞—à–∏–º –æ–ø—ã—Ç–æ–º –ø–æ–¥–æ–π–¥—É—Ç —ç—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã:\n\n";
  } else if (qualification.experience === "expert") {
    response = "–ü—Ä–µ–∫—Ä–∞—Å–Ω–æ! –î–ª—è —ç–∫—Å–ø–µ—Ä—Ç–∞ –≤–∞—à–µ–≥–æ —É—Ä–æ–≤–Ω—è:\n\n";
  } else {
    response = "–°–º–æ—Ç—Ä–∏—Ç–µ, –µ—Å—Ç—å 3 –≤–∞—Ä–∏–∞–Ω—Ç–∞:\n\n";
  }

  const topCourses = courses.slice(0, 3);

  // –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è —Å—Ç—Ä–∏–∂–µ–∫
  if (
    qualification.direction === "haircuts" &&
    qualification.format === "offline"
  ) {
    response += "**1. –°—Ç—Ä–∏–∂–∫–∏: –§—É–Ω–¥–∞–º–µ–Ω—Ç** (60,000‚ÇΩ)\n";
    response += "   üìç –ë–∞–∑–∞ –¥–ª—è –≤—Å–µ—Ö —É—Ä–æ–≤–Ω–µ–π\n";
    response += "   ‚úÖ 11 —Ñ–æ—Ä–º = —Å–∏—Å—Ç–µ–º–∞ –≤ –≥–æ–ª–æ–≤–µ\n\n";

    response += "**2. –°—Ç—Ä–∏–∂–∫–∏ 2.0** (60,000‚ÇΩ)\n";
    response += "   üìç –î–ª—è –æ–ø—ã—Ç–Ω—ã—Ö (–æ—Ç 3 –ª–µ—Ç)\n";
    response += "   ‚úÖ –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ —Ñ–æ—Ä–º—ã\n\n";

    response += "**3. –ö–æ—Ä–æ—Ç–∫–∏–µ —Å—Ç—Ä–∏–∂–∫–∏ 2.0** (70,000‚ÇΩ)\n";
    response += "   üìç –£–∑–∫–∞—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è\n";
    response += "   ‚úÖ –û—Ç 15 —Å–º –¥–æ 2-3 —Å–º –ø–æ—ç—Ç–∞–ø–Ω–æ\n\n";

    response += "**–ß–µ–º –æ—Ç–ª–∏—á–∞—é—Ç—Å—è:**\n";
    response +=
      "‚Ä¢ –§—É–Ω–¥–∞–º–µ–Ω—Ç ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–µ–º –∑–Ω–∞–Ω–∏—è –∏ —Ä–∞—Å–∫–ª–∞–¥—ã–≤–∞–µ–º –ø–æ –ø–æ–ª–æ—á–∫–∞–º\n";
    response += "‚Ä¢ 2.0 ‚Äî –∫–æ–º–º–µ—Ä—Ü–∏—è –∏ —Ç—Ä–µ–Ω–¥—ã\n";
    response += "‚Ä¢ –ö–æ—Ä–æ—Ç–∫–∏–µ ‚Äî –≥–ª—É–±–æ–∫–∞—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è\n\n";

    // –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –∫–æ–ª–æ—Ä–∏—Å—Ç–∏–∫–∏
  } else if (qualification.direction === "coloring") {
    const hasOffline = courses.some((c) => c.format === "–æ—Ñ–ª–∞–π–Ω");
    const hasOnline = courses.some((c) => c.format === "–æ–Ω–ª–∞–π–Ω");

    if (hasOffline && hasOnline) {
      response += "**1. –î–ù–ö —Ü–≤–µ—Ç–∞ (–æ—Ñ–ª–∞–π–Ω)** (60,000‚ÇΩ)\n";
      response += "   üìç 3 –¥–Ω—è –≤ –¢–≤–æ—Ä—á–µ—Å–∫–æ–π –¥–µ—Ä–µ–≤–Ω–µ\n";
      response += "   ‚úÖ –†–∏—Å–æ–≤–∞–Ω–∏–µ –∫—Ä–∞—Å–∏—Ç–µ–ª—è–º–∏ + –ø–æ–≥—Ä—É–∂–µ–Ω–∏–µ\n\n";

      response += "**2. –î–ù–ö —Ü–≤–µ—Ç–∞ (–æ–Ω–ª–∞–π–Ω)** (39,000‚ÇΩ)\n";
      response += "   üìç –í —Å–≤–æ–µ–º —Ç–µ–º–ø–µ, –¥–æ—Å—Ç—É–ø –Ω–∞–≤—Å–µ–≥–¥–∞\n";
      response += "   ‚úÖ –¢–∞ –∂–µ –ø—Ä–æ–≥—Ä–∞–º–º–∞, –Ω–æ –¥–æ–º–∞\n\n";

      response += "**3. –ù–∞—Å—Ç–∞–≤–Ω–∏–∫-–∫–æ–ª–æ—Ä–∏—Å—Ç** (65,000‚ÇΩ)\n";
      response += "   üìç –î–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç —É—á–∏—Ç—å\n";
      response += "   ‚úÖ –ú–µ—Ç–æ–¥–∏–∫–∞ –ø–µ—Ä–µ–¥–∞—á–∏ –∑–Ω–∞–Ω–∏–π\n\n";

      response += "**–ß–µ–º –æ—Ç–ª–∏—á–∞—é—Ç—Å—è:**\n";
      response += "‚Ä¢ –û—Ñ–ª–∞–π–Ω ‚Äî –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞\n";
      response += "‚Ä¢ –û–Ω–ª–∞–π–Ω ‚Äî —É–¥–æ–±–Ω–æ, –Ω–æ –Ω—É–∂–Ω–∞ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞\n";
      response += "‚Ä¢ –ù–∞—Å—Ç–∞–≤–Ω–∏–∫ ‚Äî —Å—Ç–∞–Ω—å—Ç–µ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–º\n\n";
    } else {
      // –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –∫–æ–ª–æ—Ä–∏—Å—Ç–∏–∫–∏
      topCourses.forEach((course, index) => {
        response += `**${index + 1}. ${course.name}** (${course.price?.toLocaleString("ru-RU")}‚ÇΩ)\n`;
        if (course.name.includes("–î–ù–ö")) {
          response += "   ‚úÖ –§—É–Ω–¥–∞–º–µ–Ω—Ç –∫–æ–ª–æ—Ä–∏—Å—Ç–∏–∫–∏\n";
        } else if (course.name.includes("–ù–∞—Å—Ç–∞–≤–Ω–∏–∫")) {
          response += "   ‚úÖ –ù–∞—É—á–∏—Ç–µ—Å—å –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç—å\n";
        } else if (course.name.includes("–§–∞–∫—É–ª—å—Ç–µ—Ç")) {
          response += "   ‚úÖ –£–≥–ª—É–±–ª–µ–Ω–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞\n";
        }
        response += "\n";
      });
    }

    // –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö
  } else {
    topCourses.forEach((course, index) => {
      response += `**${index + 1}. ${course.name}**\n`;
      response += `   üí∞ ${course.price?.toLocaleString("ru-RU")} ‚ÇΩ\n`;

      if (course.name.includes("–§—É–Ω–¥–∞–º–µ–Ω—Ç")) {
        response += "   ‚úÖ –ë–∞–∑–∞ –∏ —Å–∏—Å—Ç–µ–º–∞\n";
      } else if (course.name.includes("–î–ù–ö")) {
        response += "   ‚úÖ –ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ü–≤–µ—Ç–∞\n";
      } else if (course.name.includes("2.0")) {
        response += "   ‚úÖ –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å\n";
      } else if (course.name.includes("–ö–æ—Ä–æ—Ç–∫–∏–µ")) {
        response += "   ‚úÖ –°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è\n";
      }
      response += "\n";
    });
  }

  response += "üìå –û –∫–∞–∫–æ–º —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ? –ù–∞–ø–∏—à–∏—Ç–µ 1, 2 –∏–ª–∏ 3.";

  return response;
}
