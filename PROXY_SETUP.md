# üåê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–∫—Å–∏ –¥–ª—è OpenAI API

–ï—Å–ª–∏ OpenAI API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –≤ –≤–∞—à–µ–º —Ä–µ–≥–∏–æ–Ω–µ, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–∏–Ω –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–ø–æ—Å–æ–±–æ–≤:

## üìã –í–∞—Ä–∏–∞–Ω—Ç—ã –æ–±—Ö–æ–¥–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π

### 1. –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–∏—Å—ã –¥–ª—è OpenAI

–î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:
```bash
# –í–∞—Ä–∏–∞–Ω—Ç 1: OpenAI API Proxy (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π)
OPENAI_API_BASE=https://api.openai-proxy.com/v1

# –í–∞—Ä–∏–∞–Ω—Ç 2: AI Proxy
OPENAI_API_BASE=https://api.aiproxy.io/v1

# –í–∞—Ä–∏–∞–Ω—Ç 3: OpenAI SB (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
OPENAI_API_BASE=https://api.openai-sb.com/v1
```

### 2. –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å VPS –≤ —Ä–µ–≥–∏–æ–Ω–µ —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ OpenAI:

```bash
# –ù–∞ VPS —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–æ–∫—Å–∏
sudo apt update
sudo apt install squid

# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Squid –¥–ª—è HTTPS
sudo nano /etc/squid/squid.conf

# –î–æ–±–∞–≤—å—Ç–µ:
http_port 3128
https_port 3129 cert=/etc/squid/cert.pem key=/etc/squid/key.pem

# –í .env –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ:
HTTP_PROXY=http://your-vps-ip:3128
HTTPS_PROXY=http://your-vps-ip:3128
```

### 3. Cloudflare Workers (–±–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–æ 100k –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å)

–°–æ–∑–¥–∞–π—Ç–µ worker –Ω–∞ Cloudflare:

```javascript
// worker.js
addEventListener('fetch', event => {
  event.respondWith(handleRequest(event.request))
})

async function handleRequest(request) {
  const url = new URL(request.url)
  url.host = 'api.openai.com'

  const modifiedRequest = new Request(url, request)
  modifiedRequest.headers.set('Host', 'api.openai.com')

  return fetch(modifiedRequest)
}
```

–ó–∞—Ç–µ–º –≤ `.env`:
```bash
OPENAI_API_BASE=https://your-worker.workers.dev/v1
```

### 4. Shadowsocks/V2Ray

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å Shadowsocks –∏–ª–∏ V2Ray:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–π SOCKS5 –ø—Ä–æ–∫—Å–∏
# –ó–∞—Ç–µ–º –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤ HTTP –ø—Ä–æ–∫—Å–∏ —á–µ—Ä–µ–∑ privoxy

sudo apt install privoxy
sudo nano /etc/privoxy/config

# –î–æ–±–∞–≤—å—Ç–µ:
forward-socks5 / 127.0.0.1:1080 .
listen-address 127.0.0.1:8118

# –í .env:
HTTP_PROXY=http://127.0.0.1:8118
HTTPS_PROXY=http://127.0.0.1:8118
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ:

```bash
# –°–¥–µ–ª–∞–π—Ç–µ —Ñ–∞–π–ª –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x test-openai-connection.js

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç
./test-openai-connection.js
# –∏–ª–∏
node test-openai-connection.js
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–∏—Å—ã
2. **–°–∫–æ—Ä–æ—Å—Ç—å**: –ü—Ä–æ–∫—Å–∏ –º–æ–∂–µ—Ç –∑–∞–º–µ–¥–ª–∏—Ç—å –æ—Ç–≤–µ—Ç—ã AI
3. **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**: –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –ø—Ä–æ–∫—Å–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–º–∏
4. **–ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å**: –í–∞—à API –∫–ª—é—á –±—É–¥–µ—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π VPS —Å –ø—Ä–æ–∫—Å–∏
2. **–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**: –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
3. **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞**: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤ —Ä–µ–≥–∏–æ–Ω–µ —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ OpenAI

## üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ SSL/TLS
```bash
# –û—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è!)
NODE_TLS_REJECT_UNAUTHORIZED=0 bun start
```

### –¢–∞–π–º–∞—É—Ç—ã
–í `src/ai/aiAgent.ts` —É–≤–µ–ª–∏—á—å—Ç–µ —Ç–∞–π–º–∞—É—Ç:
```typescript
timeout: 60000 // 60 —Å–µ–∫—É–Ω–¥ –≤–º–µ—Å—Ç–æ 30
```

### –û—à–∏–±–∫–∞ 429 (Rate Limit)
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–¥–µ–ª—å `gpt-3.5-turbo` –≤–º–µ—Å—Ç–æ `gpt-4o-mini` –¥–ª—è –±–æ–ª—å—à–µ–≥–æ –ª–∏–º–∏—Ç–∞ –∑–∞–ø—Ä–æ—Å–æ–≤.
